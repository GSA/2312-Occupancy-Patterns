name = str_remove(name, "rule_based_"),
name = str_remove(name, "_oberservation"),
name = str_replace_all(name, "_", " "),
name = str_to_sentence(name)
)
d %>%
summarise(
across(
.cols = starts_with("rule_based"),
.fns = sum
)
) %>%
select(-contains("_position_category_")) %>%
select(-ends_with("working")) %>%
rownames_to_column() %>%
pivot_longer(-rowname) %>%
select(-rowname) %>%
mutate(
name = str_remove(name, "rule_based_"),
name = str_remove(name, "_observation"),
name = str_replace_all(name, "_", " "),
name = str_to_sentence(name)
)
d %>%
summarise(
across(
.cols = starts_with("rule_based"),
.fns = sum
)
)
d %>%
summarise(
across(
.cols = starts_with("rule_based"),
.fns = sum
)
) %>%
select(-contains("_position_category_")) %>%
select(-ends_with("working")) %>%
rownames_to_column() %>%
pivot_longer(-rowname) %>%
select(-rowname) %>%
mutate(
name = str_remove(name, "rule_based_"),
name = str_remove(name, "_observation"),
name = str_replace_all(name, "_", " "),
name = str_to_sentence(name),
name = fct_relevel(name,
"All remote",
)
)
d %>%
summarise(
across(
.cols = starts_with("rule_based"),
.fns = ~sum(.,rm.na = T)
)
) %>%
select(-contains("_position_category_")) %>%
select(-ends_with("working")) %>%
rownames_to_column() %>%
pivot_longer(-rowname) %>%
select(-rowname) %>%
mutate(
name = str_remove(name, "rule_based_"),
name = str_remove(name, "_observation"),
name = str_replace_all(name, "_", " "),
name = str_to_sentence(name),
name = fct_relevel(name,
"All remote",
)
)
d %>%
summarise(
across(
.cols = starts_with("rule_based"),
.fns = ~sum(.,rm.na = T)
)
) %>%
select(-contains("_position_category_")) %>%
select(-ends_with("working")) %>%
rownames_to_column() %>%
pivot_longer(-rowname) %>%
select(-rowname) %>%
mutate(
name = str_remove(name, "rule_based_"),
name = str_remove(name, "_observation"),
name = str_replace_all(name, "_", " "),
name = str_to_sentence(name),
name = fct_relevel(name,
"Primarily teleworking",
"Mostly teleworking",
"Mostly reporting to job site",
"Primarily reporting to job site"
"All remote",
d %>%
summarise(
across(
.cols = starts_with("rule_based"),
.fns = ~sum(.,rm.na = T)
)
) %>%
select(-contains("_position_category_")) %>%
select(-ends_with("working")) %>%
rownames_to_column() %>%
pivot_longer(-rowname) %>%
select(-rowname) %>%
mutate(
name = str_remove(name, "rule_based_"),
name = str_remove(name, "_observation"),
name = str_replace_all(name, "_", " "),
name = str_to_sentence(name),
name = fct_relevel(name,
"Primarily teleworking",
"Mostly teleworking",
"Mostly reporting to job site",
"Primarily reporting to job site",
"All remote",
"Telework onsite minimum"
)
)
d %>%
summarise(across(
.cols = starts_with("rule_based"),
.fns = ~ sum(., rm.na = T)
)) %>%
select(-contains("_position_category_")) %>%
select(-ends_with("working")) %>%
rownames_to_column() %>%
pivot_longer(-rowname) %>%
select(-rowname) %>%
mutate(
name = str_remove(name, "rule_based_"),
name = str_remove(name, "_observation"),
name = str_replace_all(name, "_", " "),
name = str_to_sentence(name),
name = fct_relevel(
name,
"Primarily teleworking",
"Mostly teleworking",
"Mostly reporting to job site",
"Primarily reporting to job site",
"All remote",
"Telework onsite minimum"
)
)
d %>%
summarise(across(
.cols = starts_with("rule_based"),
.fns = ~ sum(., rm.na = T)
)) %>%
select(-contains("_position_category_")) %>%
select(-ends_with("working")) %>%
rownames_to_column() %>%
pivot_longer(-rowname) %>%
select(-rowname) %>%
mutate(
name = str_remove(name, "rule_based_"),
name = str_remove(name, "_observation"),
name = str_replace_all(name, "_", " "),
name = str_to_sentence(name),
name = fct_relevel(
name,
"Primarily teleworking",
"Mostly teleworking",
"Mostly reporting to job site",
"Primarily reporting to job site",
"All remote",
"Telework onsite minimum"
)
) %>%
arrange(name)
d %>%
summarise(across(
.cols = starts_with("rule_based"),
.fns = ~ sum(., rm.na = T)
)) %>%
select(-contains("_position_category_")) %>%
select(-ends_with("observation")) %>%
rownames_to_column() %>%
pivot_longer(-rowname) %>%
select(-rowname) %>%
mutate(
name = str_remove(name, "rule_based_"),
name = str_remove(name, "_working"),
name = str_replace_all(name, "_", " "),
name = str_to_sentence(name),
name = fct_relevel(
name,
"Primarily teleworking",
"Mostly teleworking",
"Mostly reporting to job site",
"Primarily reporting to job site",
"All remote",
"Telework onsite minimum"
)
) %>%
arrange(name)
p_1 <-
prep_d_01 %>%
ggplot(
aes(x = name, y = n, fill = name)
) +
geom_col() +
scale_y_continuous(labels = scales::comma) +
ylab("Employees") +
theme_light() +
theme(
legend.position = "None",
axis.title.x = element_blank(),
axis.text.x = element_text(size = 8))
p_1
prep_d_01 <-
d %>%
summarise(across(
.cols = starts_with("rule_based"),
.fns = ~ sum(., rm.na = T)
)) %>%
select(-contains("_position_category_")) %>%
select(-ends_with("observation")) %>%
rownames_to_column() %>%
pivot_longer(-rowname) %>%
select(-rowname) %>%
mutate(
name = str_remove(name, "rule_based_"),
name = str_remove(name, "_working"),
name = str_replace_all(name, "_", " "),
name = str_to_sentence(name),
name = fct_relevel(
name,
"Primarily teleworking",
"Mostly teleworking",
"Mostly reporting to job site",
"Primarily reporting to job site",
"All remote",
"Telework onsite minimum"
)
) %>%
arrange(name)
p_1 <-
prep_d_01 %>%
ggplot(
aes(x = name, y = n, fill = name)
) +
geom_col() +
scale_y_continuous(labels = scales::comma) +
ylab("Employees") +
theme_light() +
theme(
legend.position = "None",
axis.title.x = element_blank(),
axis.text.x = element_text(size = 8))
p_1
p_1 <-
prep_d_01 %>%
ggplot(
aes(x = name, y = value, fill = name)
) +
geom_col() +
scale_y_continuous(labels = scales::comma) +
ylab("Employees") +
theme_light() +
theme(
legend.position = "None",
axis.title.x = element_blank(),
axis.text.x = element_text(size = 8))
p_1
prep_d_01 <-
d %>%
summarise(across(
.cols = starts_with("rule_based"),
.fns = ~ sum(., rm.na = T)
)) %>%
select(-contains("_position_category_")) %>%
select(-ends_with("observation")) %>%
rownames_to_column() %>%
pivot_longer(-rowname) %>%
select(-rowname) %>%
mutate(
name = str_remove(name, "rule_based_"),
name = str_remove(name, "_working"),
name = str_replace_all(name, "_", " "),
name = str_to_sentence(name),
name = fct_relevel(
name,
"Primarily teleworking",
"Mostly teleworking",
"Mostly reporting to job site",
"Primarily reporting to job site",
"All remote",
"Telework onsite minimum"
),
name = fct_relabel(name, ~str_wrap(.,width = 10))
) %>%
arrange(name)
p_1 <-
prep_d_01 %>%
ggplot(
aes(x = name, y = value, fill = name)
) +
geom_col() +
scale_y_continuous(labels = scales::comma) +
ylab("Employees") +
theme_light() +
theme(
legend.position = "None",
axis.title.x = element_blank(),
axis.text.x = element_text(size = 8))
p_1
prep_d_01 <-
d %>%
summarise(across(
.cols = starts_with("rule_based"),
.fns = ~ sum(., rm.na = T)
)) %>%
select(-contains("_position_category_")) %>%
select(-ends_with("observation")) %>%
rownames_to_column() %>%
pivot_longer(-rowname) %>%
select(-rowname) %>%
mutate(
name = str_remove(name, "rule_based_"),
name = str_remove(name, "_working"),
name = str_replace_all(name, "_", " "),
name = str_to_sentence(name),
name = fct_relevel(
name,
"Primarily teleworking",
"Mostly teleworking",
"Mostly reporting to job site",
"Primarily reporting to job site",
"All remote",
"Telework onsite minimum"
),
name = fct_relabel(name, ~str_wrap(.,width = 15))
) %>%
arrange(name)
p_1 <-
prep_d_01 %>%
ggplot(
aes(x = name, y = value, fill = name)
) +
geom_col() +
scale_y_continuous(labels = scales::comma) +
ylab("Employees") +
theme_light() +
theme(
legend.position = "None",
axis.title.x = element_blank(),
axis.text.x = element_text(size = 8))
p_1
prep_d_01 <-
d %>%
summarise(across(
.cols = starts_with("rule_based"),
.fns = ~ sum(., rm.na = T)
)) %>%
select(-contains("_position_category_")) %>%
select(-ends_with("observation")) %>%
rownames_to_column() %>%
pivot_longer(-rowname) %>%
select(-rowname) %>%
mutate(
name = str_remove(name, "rule_based_"),
name = str_remove(name, "_working"),
name = str_replace_all(name, "_", " "),
name = str_to_sentence(name),
name = fct_relevel(
name,
"Primarily teleworking",
"Mostly teleworking",
"Mostly reporting to job site",
"Primarily reporting to job site",
"All remote",
"Telework onsite minimum"
),
name = fct_relabel(name, ~str_wrap(.,width = 20))
) %>%
arrange(name)
p_1 <-
prep_d_01 %>%
ggplot(
aes(x = name, y = value, fill = name)
) +
geom_col() +
scale_y_continuous(labels = scales::comma) +
ylab("Employees") +
theme_light() +
theme(
legend.position = "None",
axis.title.x = element_blank(),
axis.text.x = element_text(size = 8))
p_1
prep_d_01
prep_d_01 %>%
mutate(tot = n(d))
n(d)
prep_d_01 %>%
mutate(tot = d %>% count() %>% pull())
prep_d_01 %>%
mutate(tot = d %>% count() %>% pull(),
prop = value/tot)
prep_d_01 %>%
mutate(tot = d %>% count() %>% pull(),
prop = value/tot,
text = scales::percent(prop))
prep_d_01 %>%
mutate(tot = d %>% count() %>% pull(),
prop = value/tot,
text = scales::percent(prop, accuracy = .1))
prep_d_02 <-
prep_d_01 %>%
mutate(tot = d %>% count() %>% pull(),
prop = value/tot,
text = scales::percent(prop, accuracy = .1))
prep_d_02
p_1 <-
prep_d_01 %>%
ggplot(
aes(x = name, y = value, fill = name)
) +
geom_col() +
geom_text(data = prep_d_02, aes(x = name, y = .5*value, text = text), color = "white") +
scale_y_continuous(labels = scales::comma) +
ylab("Employees") +
theme_light() +
theme(
legend.position = "None",
axis.title.x = element_blank(),
axis.text.x = element_text(size = 8))
p_1
p_1 <-
prep_d_01 %>%
ggplot(
aes(x = name, y = value, fill = name)
) +
geom_col() +
geom_text(data = prep_d_02, aes(x = name, y = .5*value, label = text), color = "white") +
scale_y_continuous(labels = scales::comma) +
ylab("Employees") +
theme_light() +
theme(
legend.position = "None",
axis.title.x = element_blank(),
axis.text.x = element_text(size = 8))
p_1
prep_d_01 <-
d %>%
group_by(.cluster_5) %>%
count() %>%
ungroup()
p_1
prep_d_01 <-
d %>%
group_by(.cluster_5) %>%
count() %>%
ungroup()
prep_d_02 <-
prep_d_01 %>%
mutate(tot = d %>% count() %>% pull(),
prop = value/tot,
text = scales::percent(prop, accuracy = .1))
prep_d_02 <-
prep_d_01 %>%
mutate(tot = d %>% count() %>% pull(),
prop = n/tot,
text = scales::percent(prop, accuracy = .1))
p_1 <-
prep_d_01 %>%
ggplot(
aes(x = .cluster_5, y = value, fill = .cluster_5)
) +
geom_col() +
geom_text(data = prep_d_02, aes(x = .cluster_5, y = .5*value, label = text), color = "white") +
scale_y_continuous(labels = scales::comma) +
ylab("Employees") +
theme_light() +
theme(
legend.position = "None",
axis.title.x = element_blank(),
axis.text.x = element_text(size = 8))
p_1
p_1 <-
prep_d_01 %>%
ggplot(
aes(x = .cluster_5, y = n, fill = .cluster_5)
) +
geom_col() +
geom_text(data = prep_d_02, aes(x = .cluster_5, y = .5*value, label = text), color = "white") +
scale_y_continuous(labels = scales::comma) +
ylab("Employees") +
theme_light() +
theme(
legend.position = "None",
axis.title.x = element_blank(),
axis.text.x = element_text(size = 8))
p_1
p_1 <-
prep_d_01 %>%
ggplot(
aes(x = .cluster_5, y = n, fill = .cluster_5)
) +
geom_col() +
geom_text(data = prep_d_02, aes(x = .cluster_5, y = .5*n, label = text), color = "white") +
scale_y_continuous(labels = scales::comma) +
ylab("Employees") +
theme_light() +
theme(
legend.position = "None",
axis.title.x = element_blank(),
axis.text.x = element_text(size = 8))
p_1
